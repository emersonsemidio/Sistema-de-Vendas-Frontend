<div class="container mt-4">

  <!-- Loading -->
  <div *ngIf="loading" class="text-center mt-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Carregando...</span>
    </div>
    <p class="mt-2">Carregando produtos...</p>
  </div>

  <div class="botao-abrir-carrinho">
    <button class="btn btn-primary btn-sm" (click)="abrirModalCarrinho()">
      <i class="fas fa-shopping-cart"></i>
      <span class="carrinho-texto">Meu Carrinho</span>
    </button>
  </div>

  <!-- Lista de Produtos -->
  <div *ngIf="!loading" class="container-centralizado">
    <div
      *ngFor="let produto of produtos"
      class="col-md-6x col-lg-4xx col-xl-3 mb-4xs"
    >
      <div class="card produto-card h-100 mx-auto" style="max-width: 280px">
        <!-- Imagem do Produto -->
        <div class="produto-imagem-container">
          <img
            [src]="'assets/salgado.jpg'"
            [alt]="produto.nome"
            class="produto-imagem"
          />
          <div
            class="produto-status"
            [class.esgotado]="produto.quantidade === 0"
          >
            {{ produto.quantidade === 0 ? "ESGOTADO" : "DISPONÍVEL" }}
          </div>
        </div>

        <div class="card-body d-flex flex-column">
          <!-- Nome do Produto -->
          <h5 class="card-title produto-nome">{{ produto.nome }}</h5>

          <div class="produto-info flex-grow-1">
            <!-- Descrição -->
            <div class="info-item descricao" *ngIf="produto.descricao">
              <i class="fas fa-align-left"></i>
              <span class="info-text"
                >{{ produto.descricao | slice : 0 : 60
                }}{{ produto.descricao.length > 60 ? "..." : "" }}</span
              >
            </div>

            <!-- Preço -->
            <div class="info-item preco-item">
              <i class="fas fa-tag"></i>
              <span class="info-text preco"
                >R$ {{ produto.preco | number : "1.2-2" }}</span
              >
            </div>

            <div class="botao-abrir-modal">
              <button
                class="botao-comprar"
                (click)="abrirModalQuantidade(produto)"
              >
                Comprar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- <app-quantidade-modal
      [produto]="produtoSelecionado!"
      [showModal]="showModal"
      [cliente]="clienteTeste"
      (fechar)="fecharModal()"
    >
    </app-quantidade-modal> -->

    <!-- Aqui renderiza o carrinho -->

    <div *ngIf="!loading && produtos.length === 0" class="sem-produtos">
      <div class="alert alert-info">
        <i class="fas fa-info-circle"></i> Nenhum produto encontrado.
      </div>
    </div>
  </div>

    <app-quantidade-modal
      [produto]="produtoSelecionado!"
      [showModal]="showModal"
      [cliente]="clienteTeste"
      (fechar)="fecharModal()"
    >
    </app-quantidade-modal>

    <app-carrinho
      [showModal]="showModalCarrinho"
      [mercadoId]="mercadoId"
      [cliente]="clienteTeste"
      (confirmar)="onCompraRealizada($event)"
      (fechar)="fecharModalCarrinho()"
    >
    </app-carrinho>
</div>
